<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="天前"><meta name="hour-prompt" content="小时前"><meta name="minute-prompt" content="分钟前"><meta name="justnow-prompt" content="刚刚"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Python基操-自动化办公(Word)" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="1.概述" /><meta property="og:description" content="1.概述" /><link rel="canonical" href="https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/" /><meta property="og:url" content="https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/" /><meta property="og:site_name" content="Technical Blogs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-03-31T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Python基操-自动化办公(Word)" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"1.概述","headline":"Python基操-自动化办公(Word)","dateModified":"2022-04-11T20:50:04+08:00","datePublished":"2020-03-31T00:00:00+08:00","url":"https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/"},"@context":"https://schema.org"}</script><title>Python基操-自动化办公(Word) | Technical Blogs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Technical Blogs"><meta name="application-name" content="Technical Blogs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="zh-CN"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-192x192.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Technical Blogs</a></div><div class="site-subtitle font-italic">Learning by Doing, Sharing for more!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Carmanzheng" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zhengkan1993','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>Python基操-自动化办公(Word)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Python基操-自动化办公(Word)</h1><div class="post-meta text-muted"><div> 作者 <em> <a href="https://github.com/carmanzheng">carmanzheng</a> </em></div><div class="d-flex"><div> <span> 发表于 <em class="timeago" date="2020-03-31 00:00:00 +0800" data-toggle="tooltip" data-placement="bottom" title="2020-03-31, 00:00 +0800" >2020-03-31</em> </span> <span> 更新于 <em class="timeago" date="2022-04-11 20:50:04 +0800 " data-toggle="tooltip" data-placement="bottom" title="2022-04-11, 20:50 +0800" >04-11</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="6114 字"> <em>33 分钟</em>阅读</span></div></div></div><div class="post-content"><h3 id="1概述">1.概述<a href="#1概述" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>​ 在日常办公中，常用的软件就是office套件。针对<code class="language-plaintext highlighter-rouge">office word</code>、<code class="language-plaintext highlighter-rouge">office excel</code>和<code class="language-plaintext highlighter-rouge">pdf</code>的相关办公要求，python给出了相应的自动化处理的包，加速办公进程。</p><h3 id="2word-docx库">2.Word-docx库<a href="#2word-docx库" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>​ 在处理文档时，常用的是<code class="language-plaintext highlighter-rouge">office word</code>。在python的docx库中，提供了多种方法来对接office文档。</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> pip <span class="nb">install </span>python-docx	
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> pip show python-docx
Name: python-docx
Version: 0.8.11
Summary: Create and update Microsoft Word .docx files.
Home-page: https://github.com/python-openxml/python-docx
...
</pre></table></code></div></div><h4 id="21-创建docx文档">2.1 创建docx文档<a href="#21-创建docx文档" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="n">document</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'test.docx'</span><span class="p">)</span>

<span class="c1"># 打开文档（版本大于 Word 2007）
</span><span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="s">'existing-document-file.docx'</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">'new-file-name.docx'</span><span class="p">)</span>

<span class="c1"># 可以使用打开文件的方式打开docx文档
</span><span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s">'foobar.docx'</span><span class="p">,</span> <span class="s">'rb'</span><span class="p">)</span>
<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></table></code></div></div><p>通过<code class="language-plaintext highlighter-rouge">Document</code>类实例化形成<code class="language-plaintext highlighter-rouge">document</code>对象，实例化后的对象拥有多个方法</p><div class="table-wrapper"><table><thead><tr><th>方法<th>说明<tbody><tr><td><code class="language-plaintext highlighter-rouge">add_heading</code>(<em>text=u’‘</em>, <em>level=1</em>)<td>添加标题、标题等级<tr><td><code class="language-plaintext highlighter-rouge">add_page_break</code>()<td>添加分页符<tr><td><code class="language-plaintext highlighter-rouge">add_paragraph</code>(<em>text=u’‘</em>, <em>style=None</em>)<td>添加一个段落、段落等级<tr><td><code class="language-plaintext highlighter-rouge">add_picture</code>(<em>image_path_or_stream</em>, <em>width=None</em>, <em>height=None</em>）<td>添加图片<tr><td><code class="language-plaintext highlighter-rouge">add_section</code>(<em>start_type=2</em>)<td>添加一个分区<tr><td><code class="language-plaintext highlighter-rouge">add_table</code>(<em>rows</em>, <em>cols</em>, <em>style=None</em>)<td>添加表格、表格样式<tr><td><code class="language-plaintext highlighter-rouge">save</code>(<em>path_or_stream</em>)<td>存储文档</table></div><div class="table-wrapper"><table><thead><tr><th>核心属性（Document.<strong>core_properties</strong>.xxx)<th>文档可读可写的核心属性<tbody><tr><td>author<td>作者<tr><td>category<td>文档类别<tr><td>comments<td>文档说明<tr><td>content_status<td>文档说明状态、如草稿<tr><td>created<td>创建时间（datetime类型）<tr><td>identifier<td>标志符号，如ISBN<tr><td>keywords<td>文档关键词<tr><td>language<td>文档语言<tr><td>last_modified_by<td>最后修改人员<tr><td>last_printed<td>最后打印时间（datetime类型）<tr><td>modified<td>最后修改时间（datetime类型）<tr><td>revision<td>修订次数（int类型）<tr><td>subject<td>文档主题<tr><td>title<td>文档标题<tr><td>version<td>版本号</table></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">author</span> <span class="o">=</span> <span class="s">"BlackJ"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">category</span> <span class="o">=</span> <span class="s">"tech"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">comments</span> <span class="o">=</span> <span class="s">"This is a document"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">content_status</span> <span class="o">=</span> <span class="s">"draft"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">identifier</span> <span class="o">=</span> <span class="s">"ISBN:38.315"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">keywords</span> <span class="o">=</span> <span class="s">"tech class"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">language</span> <span class="o">=</span> <span class="s">"en"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">last_modified_by</span> <span class="o">=</span> <span class="s">"BlackJ"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">last_modified</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">last_printed</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2022</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">subject</span> <span class="o">=</span> <span class="s">"Tech Power"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">title</span> <span class="o">=</span> <span class="s">"Tech Power is unlimited"</span>
<span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">version</span> <span class="o">=</span> <span class="s">"1.1"</span>


<span class="k">print</span><span class="p">(</span><span class="n">document</span><span class="p">.</span><span class="n">core_properties</span><span class="p">.</span><span class="n">category</span><span class="p">)</span>
<span class="n">document</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"Tech Power.docx"</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="../../assets/images/20200331python/image-20220411142812510.png" alt="image-20220411142812510" data-proofer-ignore></p><p><img data-src="../../assets/images/20200331python/image-20220411143128998.png" alt="image-20220411143128998" data-proofer-ignore></p><h4 id="22-编辑文档">2.2 编辑文档<a href="#22-编辑文档" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">new_doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"Tech Blogs"</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="n">text</span><span class="o">=</span><span class="sa">r</span><span class="s">'''The paper presents a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks(RNNs). Motivated by recent advances in renewable energy integration and smart grids, we apply our proposed algorithm for wind speed forecasting. Renewable energy resources (wind and solar)are random in nature and, thus, their integration is facilitated with accurate short-term forecasts.In our proposed framework, we model the spatiotemporal information by a graph whose nodes are data generating entities and its edges basically model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time based on one framework. Results of a case study on recorded time series data from a collection of wind mills in the north-east of the U.S. show that the proposed DL-based forecasting algorithm significantly improves the short-term forecasts compared to a set of widely-used benchmarks models.'''</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_picture</span><span class="p">(</span><span class="s">'./source/EX01.png'</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_section</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"Tech Blogs v2.2.docx"</span><span class="p">)</span>
</pre></table></code></div></div><p>​ 生成的文档属于一个素版的文档，没有修饰和格式，纯粹的堆砌而成。所以，在这个时候，需要了解下后面的样式的内容。</p><h4 id="23-样式单位">2.3 样式单位<a href="#23-样式单位" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>​ 样式在word文档中有着灵魂作用，包括对齐方式、颜色、字体大小等等。首先介绍一下尺寸方面和颜色方面的基本知识，这个模块集中在<code class="language-plaintext highlighter-rouge">docx.shared</code>模块中，主要包括长度（<code class="language-plaintext highlighter-rouge">Length objects</code>）和颜色（<code class="language-plaintext highlighter-rouge">Length objects</code>）。</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span>  <span class="n">Inches</span><span class="p">,</span><span class="n">Cm</span><span class="p">,</span><span class="n">Pt</span><span class="p">,</span><span class="n">Mm</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span>  <span class="n">RGBColor</span>
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><code class="language-plaintext highlighter-rouge">Length objects</code><th style="text-align: left">说明<tbody><tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Inches</code><td style="text-align: left">英寸单位 width = Inches(0.5)<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Cm</code><td style="text-align: left">厘米单位 height = Cm(12)<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Mm</code><td style="text-align: left">毫米单位 width = Mm(240.5)<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Pt</code><td style="text-align: left">点单位<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Twips</code><td style="text-align: left">缇，长度单位 width = Twips(42),A twip is a twentieth of a point, 635 EMU<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">Emu</code><td style="text-align: left">英文width = Emu(457200)，1cm = 360000 EMU</table></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center"><code class="language-plaintext highlighter-rouge">RGBColor objects</code><th>表示方法<tbody><tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">RGBColor</code><td>三通道颜色表示 RGBColor(0xff, 0x99, 0xcc)<tr><td style="text-align: center"><code class="language-plaintext highlighter-rouge">RGBColor.from_string(*rgb_hex_str*)</code><td>三通道字符表示<code class="language-plaintext highlighter-rouge">RGBColor.from_string(3C2F80)</code></table></div><h4 id="24-样式格式">2.4 样式格式<a href="#24-样式格式" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>​ 上一小节列举了样式的单位，这一节具体介绍样式格式的运用。在<code class="language-plaintext highlighter-rouge">python-docx</code>这个包中，有<code class="language-plaintext highlighter-rouge">enumerations </code>模块，里面有<code class="language-plaintext highlighter-rouge">Microsoft office</code>的各种属性设置。</p><h5 id="段落样式">段落样式<a href="#段落样式" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><p>​ 对于段落样式，常见的就是对齐方式</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx.enum.text</span> <span class="kn">import</span> <span class="n">WD_ALIGN_PARAGRAPH</span>

<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">paragraph</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_ALIGN_PARAGRAPH</span><span class="p">.</span><span class="n">CENTER</span>
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>对齐方式<th>说明<tbody><tr><td>LEFT<td>Left-aligned<tr><td>CENTER<td>Center-aligned<tr><td>RIGHT<td>Right-aligned<tr><td>JUSTIFY<td>两端对齐<tr><td>DISTRIBUTE<td>分散对齐<tr><td>JUSTIFY_MED<td>上下居中<tr><td>JUSTIFY_HI<td>顶端对齐<tr><td>JUSTIFY_LOW<td>底端对齐<tr><td>THAI_JUSTIFY<td>泰式对齐</table></div><h5 id="行间距">行间距<a href="#行间距" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx.enum.text</span> <span class="kn">import</span> <span class="n">WD_LINE_SPACING</span>

<span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">paragraph</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing_rule</span> <span class="o">=</span> <span class="n">WD_LINE_SPACING</span><span class="p">.</span><span class="n">EXACTLY</span>
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>行间距<th>说明<tbody><tr><td>ONE_POINT_FIVE<td>1.5倍行距<tr><td>AT_LEAST<td>最小行距<tr><td>DOUBLE<td>2倍行距<tr><td>EXACTLY<td>固定行距<tr><td>MULTIPLE<td>多倍行距<tr><td>SINGLE<td>单倍行距</table></div><p><strong>节（section）的概念</strong></p><p>​ 一个文档中，有多个节，通过获取节来进行本节（section）内的操作</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sections</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">sections</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sections</span>
<span class="o">&lt;</span><span class="n">docx</span><span class="p">.</span><span class="n">parts</span><span class="p">.</span><span class="n">document</span><span class="p">.</span><span class="n">Sections</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x1deadbeef</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">sections</span><span class="p">)</span>
<span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">section</span> <span class="o">=</span> <span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#在section[0]中有奇偶页的设置属性
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">section</span>
<span class="o">&lt;</span><span class="n">docx</span><span class="p">.</span><span class="n">section</span><span class="p">.</span><span class="n">Section</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x1deadbeef</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">section</span> <span class="ow">in</span> <span class="n">sections</span><span class="p">:</span>
<span class="p">...</span>     <span class="k">print</span><span class="p">(</span><span class="n">section</span><span class="p">.</span><span class="n">start_type</span><span class="p">)</span>
<span class="p">...</span>
<span class="n">NEW_PAGE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">EVEN_PAGE</span> <span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">ODD_PAGE</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># 添加新节
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">current_section</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">sections</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># last section in document
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">current_section</span><span class="p">.</span><span class="n">start_type</span>
<span class="n">NEW_PAGE</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_section</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_section</span><span class="p">(</span><span class="n">WD_SECTION</span><span class="p">.</span><span class="n">ODD_PAGE</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">new_section</span><span class="p">.</span><span class="n">start_type</span>
<span class="n">ODD_PAGE</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></table></code></div></div><p><img data-src="../../assets/images/20200331python/image-20220411175503434.png" alt="image-20220411175503434" data-proofer-ignore></p><p><img data-src="../../assets/images/20200331python/image-20220411175957442.png" alt="image-20220411180117669" style="zoom:67%;" data-proofer-ignore></p><div class="table-wrapper"><table><thead><tr><th>节的属性<th>说明<tbody><tr><td>start_type<td>开始的类型<tr><td>orientation<td>方向<tr><td>page_width<td>页面宽度<tr><td>page_height<td>页面高度<tr><td>left_margin<td>文字到页面最左端的距离(页边距)<tr><td>right_margin<td>文字到页面最右端的距离<tr><td>top_margin<td>文字到页面最上端的距离<tr><td>bottom_margin<td>文字到页面最底端的距离<tr><td>header_distance<td>页眉顶端距离<tr><td>footer_distance<td>页脚底端距离<tr><td>gutter<td>装订线位置</table></div><h5 id="页眉和页脚">页眉和页脚<a href="#页眉和页脚" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">section</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># 获取第一节的页眉
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">header</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">header</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">header</span><span class="p">.</span><span class="n">is_linked_to_previous</span> <span class="o">=</span> <span class="bp">False</span> <span class="c1"># 不使用上节内容和样式
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">document</span><span class="p">.</span><span class="n">settings</span><span class="p">.</span><span class="n">odd_and_even_pages_header_footer</span> <span class="o">=</span> <span class="bp">True</span> <span class="c1"># 奇偶页不一样
</span>


<span class="o">&gt;&gt;&gt;</span> <span class="n">section</span><span class="p">.</span><span class="n">different_first_page_header_footer</span> <span class="o">=</span> <span class="bp">True</span> <span class="c1"># 设置启动首页不同
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">section</span><span class="p">.</span><span class="n">footer</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>  <span class="c1"># 页脚左对齐
</span></pre></table></code></div></div><h4 id="25-图片和表格">2.5 图片和表格<a href="#25-图片和表格" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>​ 在2.2小节已经用到了插入图片和表格，本小节细化一下</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>

<span class="n">new_doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"Tech Blogs"</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">add_picture</span><span class="p">(</span><span class="s">'./source/EX01.png'</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="n">Inches</span><span class="p">(</span><span class="mf">1.25</span><span class="p">))</span>


<span class="n">new_doc</span><span class="p">.</span><span class="n">add_table</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="err">，</span><span class="n">style</span><span class="o">=</span><span class="s">'Medium Grid 1 Accent 1'</span><span class="p">)</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"Tech Blogs v2.2.docx"</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="c1"># 查看docx中包含的表格样式
</span><span class="kn">from</span> <span class="nn">docx.enum.style</span> <span class="kn">import</span> <span class="n">WD_STYLE_TYPE</span>
<span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="n">d</span><span class="p">.</span><span class="o">=</span><span class="n">Document</span><span class="p">()</span>
<span class="n">styles</span><span class="o">=</span><span class="n">d</span><span class="p">.</span><span class="n">styles</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">styles</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">.</span><span class="nb">type</span><span class="o">==</span><span class="n">WD_STYLE_TYPE</span><span class="p">.</span><span class="n">TABLE</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">name</span><span class="p">)</span>
</pre></table></code></div></div><h5 id="表格列宽">表格列宽<a href="#表格列宽" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5>1. 可以使表格自动适应窗口大小: <code class="language-plaintext highlighter-rouge">table.autofit=True</code> 2. 设置列宽尺寸<code class="language-plaintext highlighter-rouge">table.cell(row,col).width=Cm(4) </code><h5 id="表格行高">表格行高<a href="#表格行高" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><ol><li>设置行高尺寸<code class="language-plaintext highlighter-rouge">table.rows[0].height=Cm(12)</code></ol><h5 id="表格对齐方式">表格对齐方式<a href="#表格对齐方式" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">table</span><span class="p">.</span><span class="n">alignment</span><span class="o">=</span><span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span><span class="o">|</span><span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span><span class="o">|</span><span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">RIGHT</span>
</pre></table></code></div></div><h5 id="合并单元格">合并单元格<a href="#合并单元格" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c1"># 在表格中每个单元格都有一个代码，cell(row,col)，row表示行号，col表示列号，从0开始计数
</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row1</span><span class="p">,</span><span class="n">col1</span><span class="p">).</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row2</span><span class="p">,</span><span class="n">col2</span><span class="p">))</span>
</pre></table></code></div></div><p>如果是<code class="language-plaintext highlighter-rouge">cell(row1,col1)</code>是<code class="language-plaintext highlighter-rouge">cell(1,0）</code>,<code class="language-plaintext highlighter-rouge">cell(row2,col2)</code>是<code class="language-plaintext highlighter-rouge">cell(1,2)</code>，那么合并的就是<code class="language-plaintext highlighter-rouge">cell(1,0)</code>、<code class="language-plaintext highlighter-rouge">cell(1,1)</code>、<code class="language-plaintext highlighter-rouge">cell(1,2)</code>三个单元格。</p><h5 id="表格文字样式">表格文字样式<a href="#表格文字样式" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1"># 表格中文字样式修改，与在段落中的样式修改一样，只是在添加文本时调用的方法不同。
</span><span class="n">run</span><span class="o">=</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>   <span class="c1">#添加文本的方法
</span><span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>  
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span><span class="o">=</span><span class="bp">True</span>
</pre></table></code></div></div><h5 id="表格文字对齐">表格文字对齐<a href="#表格文字对齐" class="anchor"><i class="fas fa-hashtag"></i></a></h5></h5><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1"># 水平对齐
</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span><span class="o">=</span><span class="n">WD_ALIGN_PARAGRAPH</span><span class="p">.</span><span class="n">CENTER</span> <span class="o">|</span><span class="n">WD_ALIGN_PARAGRAPH</span><span class="p">.</span><span class="n">LEFT</span><span class="o">|</span><span class="n">WD_ALIGN_PARAGRAPH</span><span class="p">.</span><span class="n">RIGHT</span>
<span class="c1"># 垂直对齐
</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">).</span><span class="n">vertical_alignment</span><span class="o">=</span><span class="n">WD_ALIGN_VERTICAL</span><span class="p">.</span><span class="n">CENTER</span> <span class="o">|</span><span class="n">WD_ALIGN_VERTICAL</span><span class="p">.</span><span class="n">TOP</span><span class="o">|</span><span class="n">WD_ALIGN_VERTICAL</span><span class="p">.</span><span class="n">BOTTOM</span>
</pre></table></code></div></div><p>综合案例</p><p><img data-src="../../assets/images/20200331python/image-20220411203938527.png" alt="image-20220411203938527" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Cm</span><span class="p">,</span> <span class="n">Pt</span>

<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">RGBColor</span>
<span class="kn">from</span> <span class="nn">docx.enum.text</span> <span class="kn">import</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span>
<span class="kn">from</span> <span class="nn">docx.oxml.ns</span> <span class="kn">import</span> <span class="n">qn</span>

<span class="kn">from</span> <span class="nn">docx.enum.table</span> <span class="kn">import</span> <span class="n">WD_TABLE_ALIGNMENT</span>

<span class="s">'''
# 查看docx中包含的表格样式
from docx.enum.style import WD_STYLE_TYPE
from docx import Document

d = Document()
styles = d.styles
for s in styles:
    if s.type == WD_STYLE_TYPE.TABLE:
        print(s.name)
'''</span>

<span class="c1"># 首先创建一个文档对象
</span><span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>

<span class="c1"># 修改页面为横板
</span><span class="n">sections</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">sections</span>
<span class="n">section</span> <span class="o">=</span> <span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">new_pagewidth</span><span class="p">,</span> <span class="n">new_pageheight</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">page_height</span><span class="p">,</span> <span class="n">section</span><span class="p">.</span><span class="n">page_width</span>
<span class="n">section</span><span class="p">.</span><span class="n">page_height</span> <span class="o">=</span> <span class="n">new_pageheight</span>
<span class="n">section</span><span class="p">.</span><span class="n">page_width</span> <span class="o">=</span> <span class="n">new_pagewidth</span>

<span class="c1"># 添加标题,并修改字体样式
</span><span class="n">head</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">head</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'表格'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'黑体'</span>  <span class="c1"># 设置字体为黑体
</span><span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>  <span class="c1"># 设置大小为24磅
</span><span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># 设置颜色为黑色
</span><span class="n">head</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>  <span class="c1"># 居中
</span>
<span class="c1"># 添加子文档
</span><span class="n">p</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'2019年03月24日至2020年03月25日'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># 设置大小为14磅
</span><span class="n">p</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">RIGHT</span>  <span class="c1"># 右对齐
</span>
<span class="c1"># 表格操作
</span><span class="n">colss</span> <span class="o">=</span> <span class="mi">11</span>  <span class="c1"># 表格的总列数
</span><span class="n">table</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_table</span><span class="p">(</span><span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="n">colss</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s">'Table Grid'</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>

<span class="c1"># 表格标题行，并设置字体
</span><span class="n">hdr_cells</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">cells</span>
<span class="n">Fields</span> <span class="o">=</span> <span class="p">[</span><span class="s">'序号'</span><span class="p">,</span> <span class="s">'字段'</span><span class="p">,</span> <span class="s">'日期'</span><span class="p">,</span> <span class="s">'x1'</span><span class="p">,</span> <span class="s">'y1'</span><span class="p">,</span> <span class="s">'x2'</span><span class="p">,</span> <span class="s">'y2'</span><span class="p">,</span> <span class="s">'重要性'</span><span class="p">,</span> <span class="s">'整数'</span><span class="p">,</span> <span class="s">'类型'</span><span class="p">,</span> <span class="s">'备注'</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">colss</span><span class="p">):</span>
    <span class="n">hdr_cells</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
    <span class="n">run</span> <span class="o">=</span> <span class="n">hdr_cells</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="n">Fields</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
    <span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
    <span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">hdr_cells</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">width</span> <span class="o">=</span> <span class="n">Cm</span><span class="p">(</span><span class="mf">2.7</span><span class="p">)</span>

<span class="c1"># 写入表格数据
</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-04'</span><span class="p">,</span> <span class="o">-</span><span class="mf">102.36</span><span class="p">,</span> <span class="mf">1254.03</span><span class="p">,</span> <span class="mf">23.00</span><span class="p">,</span> <span class="mf">1635.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-04'</span><span class="p">,</span> <span class="o">-</span><span class="mf">102.36</span><span class="p">,</span> <span class="mf">1254.03</span><span class="p">,</span> <span class="mf">23.00</span><span class="p">,</span> <span class="mf">1635.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-04'</span><span class="p">,</span> <span class="o">-</span><span class="mf">102.36</span><span class="p">,</span> <span class="mf">1254.03</span><span class="p">,</span> <span class="mf">23.00</span><span class="p">,</span> <span class="mf">1635.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-04'</span><span class="p">,</span> <span class="o">-</span><span class="mf">102.36</span><span class="p">,</span> <span class="mf">1254.03</span><span class="p">,</span> <span class="mf">23.00</span><span class="p">,</span> <span class="mf">1635.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-04'</span><span class="p">,</span> <span class="o">-</span><span class="mf">102.36</span><span class="p">,</span> <span class="mf">1254.03</span><span class="p">,</span> <span class="mf">23.00</span><span class="p">,</span> <span class="mf">1635.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-25'</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.36</span><span class="p">,</span> <span class="mf">154.03</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-25'</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.36</span><span class="p">,</span> <span class="mf">154.03</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-25'</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.36</span><span class="p">,</span> <span class="mf">154.03</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-25'</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.36</span><span class="p">,</span> <span class="mf">154.03</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="s">'B'</span><span class="p">,</span> <span class="s">'2020-03-25'</span><span class="p">,</span> <span class="o">-</span><span class="mf">12.36</span><span class="p">,</span> <span class="mf">154.03</span><span class="p">,</span> <span class="mf">2.00</span><span class="p">,</span> <span class="mf">165.2</span><span class="p">,</span> <span class="s">"正常"</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s">'P'</span><span class="p">,</span> <span class="s">''</span><span class="p">]</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">row_cells</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">add_row</span><span class="p">().</span><span class="n">cells</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">line</span><span class="p">):</span>
        <span class="n">row_cells</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
        <span class="n">run</span> <span class="o">=</span> <span class="n">row_cells</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">d</span><span class="p">))</span>
        <span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
        <span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>

<span class="c1"># 合并第二列单元格
</span><span class="n">rowss</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">rowss</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">text</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="s">'B'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">vertical_alignment</span> <span class="o">=</span> <span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>

<span class="c1"># 合并第三列单元格
</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">text</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="s">'2020-3-24'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">).</span><span class="n">vertical_alignment</span> <span class="o">=</span> <span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>

<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">).</span><span class="n">merge</span><span class="p">(</span><span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="n">rowss</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">).</span><span class="n">text</span> <span class="o">=</span> <span class="s">''</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">).</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="s">'2020-3-25'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">table</span><span class="p">.</span><span class="n">cell</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">rowss</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="mi">2</span><span class="p">).</span><span class="n">vertical_alignment</span> <span class="o">=</span> <span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>

<span class="c1"># 写入表格其他信息
</span><span class="n">p</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'编制单位：'</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_parent</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_before</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c1"># 段前间距
</span><span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># 设置大小为14磅
</span><span class="n">p</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">RIGHT</span>  <span class="c1"># 右对齐
</span><span class="n">p</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'编制人：'</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">+</span> <span class="s">'审核：'</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_element</span><span class="p">.</span><span class="n">rPr</span><span class="p">.</span><span class="n">rFonts</span><span class="p">.</span><span class="nb">set</span><span class="p">(</span><span class="n">qn</span><span class="p">(</span><span class="s">'w:eastAsia'</span><span class="p">),</span> <span class="sa">u</span><span class="s">'宋体'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>  <span class="c1"># 设置大小为14磅
</span><span class="n">p</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_TABLE_ALIGNMENT</span><span class="p">.</span><span class="n">RIGHT</span>  <span class="c1"># 右对齐
</span>
<span class="c1"># 将文档保存到docx中
</span><span class="k">try</span><span class="p">:</span>
    <span class="n">document</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"Tech Blogs v2.5.docx"</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"Tech Blogs v2.5.docx文件已保存"</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"文件被占用，请关闭后重试！"</span><span class="p">)</span>

</pre></table></code></div></div><h4 id="26再次编辑文档">2.6再次编辑文档<a href="#26再次编辑文档" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>​ 在加入了段落后，需要注意的是段落属性<code class="language-plaintext highlighter-rouge">Paragraph properties</code>,通过<code class="language-plaintext highlighter-rouge">paragraph.paragraph_format</code>可以访问。</p><p>分析一下，段落：即由字符组成句子，句子组成段落。</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>字符 <span class="nt">---</span> 字体样式（加粗、倾斜、下滑线、删除线...）、字体大小、字体颜色
句子 <span class="nt">---</span> 行距
段落 <span class="nt">---</span> 段前段后间距、段落对齐方式、段落缩进方式
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.enum.text</span> <span class="kn">import</span> <span class="n">WD_ALIGN_PARAGRAPH</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Inches</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span> <span class="o">=</span> <span class="n">paragraph</span><span class="p">.</span><span class="n">paragraph_format</span>
</pre></table></code></div></div><p><strong>水平对齐（Horizontal alignment (justification)）</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_ALIGN_PARAGRAPH</span><span class="p">.</span><span class="n">CENTER</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">alignment</span>
<span class="n">CENTER</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>缩进（Indentation）</strong></p><p><img data-src="../../assets/images/20200331python/image-20220411160751509.png" alt="image-20220411160751509" data-proofer-ignore></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="c1"># 左缩进
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">left_indent</span> <span class="o">=</span> <span class="n">Inches</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">left_indent</span>
<span class="mi">457200</span>
<span class="c1"># 右缩进
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">right_indent</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">right_indent</span>
<span class="mi">304800</span>
<span class="c1"># 首行缩进
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span>
<span class="bp">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span> <span class="o">=</span> <span class="n">Inches</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span>
<span class="o">-</span><span class="mi">228600</span>

</pre></table></code></div></div><p>​ 精讲一下，一般在文档编辑的过程中，需要首行缩进2字符。但是，这个字符的大小是随着字体的大小变化而变化的，所以，需要设置或者找出字体的大小，然后乘以2即可。</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c1"># 
</span><span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">10.5</span><span class="p">)</span>
<span class="n">p1</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span> <span class="o">=</span> <span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span>
</pre></table></code></div></div><p><strong>行距</strong></p><p>​ 行距通过两个属性来设定，行距<code class="language-plaintext highlighter-rouge">line_spacing</code>和行距规则<code class="language-plaintext highlighter-rouge">line_spacing_rule</code>，参考2.4小节的行间距规则。</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Length</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span>
<span class="bp">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing_rule</span>
<span class="bp">None</span>

<span class="c1"># 设置固定行距，需要制定具体数值单位
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span><span class="p">,</span> <span class="n">Length</span><span class="p">)</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span><span class="p">.</span><span class="n">pt</span>
<span class="mf">18.0</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing_rule</span>
<span class="n">EXACTLY</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># 设置多倍行距，直接写浮点数据
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span> <span class="o">=</span> <span class="mf">1.75</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing</span>
<span class="mf">1.75</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">line_spacing_rule</span>
<span class="n">MULTIPLE</span> <span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></table></code></div></div><p><strong>段前段后间距（Paragraph spacing）</strong></p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_before</span><span class="p">,</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_after</span>
<span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>  <span class="c1"># inherited by default
</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_before</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_before</span><span class="p">.</span><span class="n">pt</span>
<span class="mf">18.0</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_after</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_after</span><span class="p">.</span><span class="n">pt</span>
<span class="mf">12.0</span>

<span class="c1"># 在使用run等级的时候，需要用到_parent
</span><span class="n">p</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">run</span> <span class="o">=</span> <span class="n">p</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'编制单位：'</span> <span class="o">+</span> <span class="s">'_'</span> <span class="o">*</span> <span class="mi">20</span> <span class="o">+</span> <span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>
<span class="n">run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">u</span><span class="s">'宋体'</span>
<span class="n">run</span><span class="p">.</span><span class="n">_parent</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">space_before</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c1"># 段前间距
</span></pre></table></code></div></div><p><strong>分页属性(Pagination properties)</strong></p><p>​ 这个分页有点不太懂~</p><div class="table-wrapper"><table><thead><tr><th>分页方式（布尔类型）<th>说明<tbody><tr><td>keep_together<td>整个段落归于后一页中；如果段落分跨两页，分页符在段首<tr><td>keep_with_next<td>段落应与后续段落保持在同一页面上。例如，此属性可用于将节标题与其第一段保持在同一页上<tr><td>page_break_before<td>段落前分页，使得被纸张分开的段落全部位于第二页上<tr><td>widow_control<td>文档重排时，第一行与最后一行与段落均位于同一纸张</table></div><p><strong>字符操作</strong></p><p>​ 字符操作通过<code class="language-plaintext highlighter-rouge">run</code>级别来实现。</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">document</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">run</span> <span class="o">=</span> <span class="n">document</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">().</span><span class="n">add_run</span><span class="p">()</span>
<span class="c1"># 访问运行的字体
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">font</span> <span class="o">=</span> <span class="n">run</span><span class="p">.</span><span class="n">font</span>

<span class="c1"># 字体样式与大小设置
</span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">'Calibri'</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>

<span class="c1"># 字体加粗与倾斜
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">bold</span><span class="p">,</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span>
<span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span>
<span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span>
<span class="bp">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span> <span class="o">=</span> <span class="bp">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">italic</span>
<span class="bp">None</span>

<span class="c1"># 下划线
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">underline</span>
<span class="bp">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">underline</span> <span class="o">=</span> <span class="bp">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="c1"># or perhaps
</span><span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">underline</span> <span class="o">=</span> <span class="n">WD_UNDERLINE</span><span class="p">.</span><span class="n">DOT_DASH</span>

<span class="c1"># 字体颜色
</span><span class="o">&gt;&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">RGBColor</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mh">0x42</span><span class="p">,</span> <span class="mh">0x24</span><span class="p">,</span> <span class="mh">0xE9</span><span class="p">)</span>
<span class="c1"># 示例第一段小标题
</span><span class="n">p1_0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p1_0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">font_s</span> <span class="o">=</span> <span class="n">p1_0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">"Abstract"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># 设置主题颜色
</span><span class="o">&gt;&gt;</span> <span class="kn">from</span> <span class="nn">docx.enum.dml</span> <span class="kn">import</span> <span class="n">MSO_THEME_COLOR</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">theme_color</span> <span class="o">=</span> <span class="n">MSO_THEME_COLOR</span><span class="p">.</span><span class="n">ACCENT_1</span>
</pre></table></code></div></div><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c1"># 示例
</span><span class="n">p0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="c1"># 设置文字的样式，需要把文字写到run后面的文字中
</span><span class="n">font_s</span> <span class="o">=</span> <span class="n">p0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"Amir Ghaderi Borhan M. Sanandaji  Faezeh Ghaderi"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
</pre></table></code></div></div><p>明白上面的属性之后，开始写一段代码</p><div class="language-python highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="nn">docx</span> <span class="kn">import</span> <span class="n">Document</span>
<span class="kn">from</span> <span class="nn">docx.shared</span> <span class="kn">import</span> <span class="n">Pt</span><span class="p">,</span> <span class="n">RGBColor</span><span class="p">,</span> <span class="n">Inches</span>
<span class="kn">from</span> <span class="nn">docx.enum.text</span> <span class="kn">import</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span>

<span class="n">new_doc</span> <span class="o">=</span> <span class="n">Document</span><span class="p">()</span>
<span class="c1"># 设置标题
</span><span class="n">head</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_heading</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"Deep Forecast:Deep Learning-based Spatio-Temporal Forecasting"</span><span class="p">)</span>
<span class="n">head</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="c1"># 设置作者
</span><span class="n">p0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="c1"># 设置文字的样式，需要把文字写到run后面的文字中
</span><span class="n">font_s</span> <span class="o">=</span> <span class="n">p0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">"Amir Ghaderi Borhan M. Sanandaji  Faezeh Ghaderi"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>

<span class="c1"># 第一段小标题
</span><span class="n">p1_0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p1_0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">font_s</span> <span class="o">=</span> <span class="n">p1_0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">"Abstract"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">color</span><span class="p">.</span><span class="n">rgb</span> <span class="o">=</span> <span class="n">RGBColor</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># 第一段内容
</span><span class="n">p1</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span>
    <span class="s">'The paper presents a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks(RNNs). Motivated by recent advances in renewable energy integration and smart grids, we apply our proposed algorithm for wind speed forecasting. Renewable energy resources (wind and solar)are random in nature and, thus, their integration is facilitated with accurate short-term forecasts.In our proposed framework, we model the spatiotemporal information by a graph whose nodes are data generating entities and its edges basically model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time based on one framework. Results of a case study on recorded time series data from a collection of wind mills in the north-east of the U.S. show that the proposed DL-based forecasting algorithm significantly improves the short-term forecasts compared to a set of widely-used benchmarks models.'</span><span class="p">)</span>
<span class="n">p1</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mf">10.5</span><span class="p">)</span>
<span class="n">p1</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span> <span class="o">=</span> <span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># 第二段小标题
</span><span class="n">p2_0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p2_0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">font_s</span> <span class="o">=</span> <span class="n">p2_0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">"1. Introduction"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
<span class="c1"># 第二段内容
</span><span class="n">p2</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'''Many countries in the world and many states in the U.S. have mandated aggressive Renewable Portfolio Standards (RPSs). Among different renewable energy resources, wind energy itself is expected to grow to provide between 15 to 25% of the world’s global electricity by 2050. According to another study, the world total wind power capacity has doubled every three years since 2000, reaching an installed capacity of 197 GW in 2010 and 369 GW in 2014 (CEC, 2013), (IEA, 2013). The random nature of wind, however, makes it difficult to achieve the power balance needed for its grid integration (Smith et al., 2007). The use of ancillary services such as frequency regulation and load following to compensate for such imbalances is facilitated by accurate forecasts (Hao et al., 2013), (Sanandaji et al., 2014). We present a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks (RNNs). In our proposed framework, we model the spatio-temporal information by a graph whose nodes are data generating entities and its edges model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time and using one framework. One of the most important points is that we do not know the relationship between stations and the trained model determines which stations are more important to forecast one specific station. Our code and data are available at https://github.com/amirstar/Deep-Forecast One can directly attempt to forecast wind power. An alternative approach is to forecast the wind speed and then convert it to wind power using given power curves. This approach will accommodate different wind turbines installed in a wind farm experiencing the same wind speed profile but resulting in different wind power generation. We focus on wind speed forecasting in this paper. Wind speed forecasting methods can be categorized to different groups: (i) model-based methods such as Numerical Weather Prediction (NWP) vs. data-driven methods, (ii) point forecasting vs. probabilistic forecasting, and (iii) short-term forecasting vs. long-term forecasting. This paper is concerned with short-term point forecasting using both temporal data as well as spatial information. For a more complete survey of wind speed forecasting methods see (Zhu &amp; Genton, 2012)
'''</span><span class="p">)</span>
<span class="n">p2</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">p2</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span> <span class="o">=</span> <span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># 第三段小标题
</span><span class="n">p3_0</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">()</span>
<span class="n">p3_0</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">font_s</span> <span class="o">=</span> <span class="n">p3_0</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">"2. Related works"</span><span class="p">)</span>
<span class="n">font_s</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">bold</span> <span class="o">=</span> <span class="bp">True</span>
<span class="c1"># 第三段内容
</span><span class="n">p3</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">add_paragraph</span><span class="p">(</span><span class="s">'''
Many countries in the world and many states in the U.S. have mandated aggressive Renewable Portfolio Standards (RPSs). Among different renewable energy resources, wind energy itself is expected to grow to provide between 15 to 25% of the world’s global electricity by 2050. According to another study, the world total wind power capacity has doubled every three years since 2000, reaching an installed capacity of 197 GW in 2010 and 369 GW in 2014 (CEC, 2013), (IEA, 2013). The random nature of wind, however, makes it difficult to achieve the power balance needed for its grid integration (Smith et al., 2007). The use of ancillary services such as frequency regulation and load following to compensate for such imbalances is facilitated by accurate forecasts (Hao et al., 2013), (Sanandaji et al., 2014). We present a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks (RNNs). In our proposed framework, we model the spatio-temporal information by a graph whose nodes are data generating entities and its edges model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time and using one framework. One of the most important points is that we do not know the relationship between stations and the trained model determines which stations are more important to forecast one specific station. Our code and data are available at https://github.com/amirstar/Deep-Forecast One can directly attempt to forecast wind power. An alternative approach is to forecast the wind speed and then convert it to wind power using given power curves. This approach will accommodate different wind turbines installed in a wind farm experiencing the same wind speed profile but resulting in different wind power generation. We focus on wind speed forecasting in this paper. Wind speed forecasting methods can be categorized to different groups: (i) model-based methods such as Numerical Weather Prediction (NWP) vs. data-driven methods, (ii) point forecasting vs. probabilistic forecasting, and (iii) short-term forecasting vs. long-term forecasting. This paper is concerned with short-term point forecasting using both temporal data as well as spatial information. For a more complete survey of wind speed forecasting methods see (Zhu &amp; Genton, 2012)
Many countries in the world and many states in the U.S. have mandated aggressive Renewable Portfolio Standards (RPSs). Among different renewable energy resources, wind energy itself is expected to grow to provide between 15 to 25% of the world’s global electricity by 2050. According to another study, the world total wind power capacity has doubled every three years since 2000, reaching an installed capacity of 197 GW in 2010 and 369 GW in 2014 (CEC, 2013), (IEA, 2013). The random nature of wind, however, makes it difficult to achieve the power balance needed for its grid integration (Smith et al., 2007). The use of ancillary services such as frequency regulation and load following to compensate for such imbalances is facilitated by accurate forecasts (Hao et al., 2013), (Sanandaji et al., 2014). We present a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks (RNNs). In our proposed framework, we model the spatio-temporal information by a graph whose nodes are data generating entities and its edges model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time and using one framework. One of the most important points is that we do not know the relationship between stations and the trained model determines which stations are more important to forecast one specific station. Our code and data are available at https://github.com/amirstar/Deep-Forecast One can directly attempt to forecast wind power. An alternative approach is to forecast the wind speed and then convert it to wind power using given power curves. This approach will accommodate different wind turbines installed in a wind farm experiencing the same wind speed profile but resulting in different wind power generation. We focus on wind speed forecasting in this paper. Wind speed forecasting methods can be categorized to different groups: (i) model-based methods such as Numerical Weather Prediction (NWP) vs. data-driven methods, (ii) point forecasting vs. probabilistic forecasting, and (iii) short-term forecasting vs. long-term forecasting. This paper is concerned with short-term point forecasting using both temporal data as well as spatial information. For a more complete survey of wind speed forecasting methods see (Zhu &amp; Genton, 2012)
Many countries in the world and many states in the U.S. have mandated aggressive Renewable Portfolio Standards (RPSs). Among different renewable energy resources, wind energy itself is expected to grow to provide between 15 to 25% of the world’s global electricity by 2050. According to another study, the world total wind power capacity has doubled every three years since 2000, reaching an installed capacity of 197 GW in 2010 and 369 GW in 2014 (CEC, 2013), (IEA, 2013). The random nature of wind, however, makes it difficult to achieve the power balance needed for its grid integration (Smith et al., 2007). The use of ancillary services such as frequency regulation and load following to compensate for such imbalances is facilitated by accurate forecasts (Hao et al., 2013), (Sanandaji et al., 2014). We present a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks (RNNs). In our proposed framework, we model the spatio-temporal information by a graph whose nodes are data generating entities and its edges model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time and using one framework. One of the most important points is that we do not know the relationship between stations and the trained model determines which stations are more important to forecast one specific station. Our code and data are available at https://github.com/amirstar/Deep-Forecast One can directly attempt to forecast wind power. An alternative approach is to forecast the wind speed and then convert it to wind power using given power curves. This approach will accommodate different wind turbines installed in a wind farm experiencing the same wind speed profile but resulting in different wind power generation. We focus on wind speed forecasting in this paper. Wind speed forecasting methods can be categorized to different groups: (i) model-based methods such as Numerical Weather Prediction (NWP) vs. data-driven methods, (ii) point forecasting vs. probabilistic forecasting, and (iii) short-term forecasting vs. long-term forecasting. This paper is concerned with short-term point forecasting using both temporal data as well as spatial information. For a more complete survey of wind speed forecasting methods see (Zhu &amp; Genton, 2012)
Many countries in the world and many states in the U.S. have mandated aggressive Renewable Portfolio Standards (RPSs). Among different renewable energy resources, wind energy itself is expected to grow to provide between 15 to 25% of the world’s global electricity by 2050. According to another study, the world total wind power capacity has doubled every three years since 2000, reaching an installed capacity of 197 GW in 2010 and 369 GW in 2014 (CEC, 2013), (IEA, 2013). The random nature of wind, however, makes it difficult to achieve the power balance needed for its grid integration (Smith et al., 2007). The use of ancillary services such as frequency regulation and load following to compensate for such imbalances is facilitated by accurate forecasts (Hao et al., 2013), (Sanandaji et al., 2014). We present a spatio-temporal wind speed forecasting algorithm using Deep Learning (DL) and in particular, Recurrent Neural Networks (RNNs). In our proposed framework, we model the spatio-temporal information by a graph whose nodes are data generating entities and its edges model how these nodes are interacting with each other. One of the main contributions of our work is the fact that we obtain forecasts of all nodes of the graph at the same time and using one framework. One of the most important points is that we do not know the relationship between stations and the trained model determines which stations are more important to forecast one specific station. Our code and data are available at https://github.com/amirstar/Deep-Forecast One can directly attempt to forecast wind power. An alternative approach is to forecast the wind speed and then convert it to wind power using given power curves. This approach will accommodate different wind turbines installed in a wind farm experiencing the same wind speed profile but resulting in different wind power generation. We focus on wind speed forecasting in this paper. Wind speed forecasting methods can be categorized to different groups: (i) model-based methods such as Numerical Weather Prediction (NWP) vs. data-driven methods, (ii) point forecasting vs. probabilistic forecasting, and (iii) short-term forecasting vs. long-term forecasting. This paper is concerned with short-term point forecasting using both temporal data as well as spatial information. For a more complete survey of wind speed forecasting methods see (Zhu &amp; Genton, 2012)

'''</span><span class="p">)</span>
<span class="n">p3</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">LEFT</span>
<span class="n">p3</span><span class="p">.</span><span class="n">paragraph_format</span><span class="p">.</span><span class="n">first_line_indent</span> <span class="o">=</span> <span class="n">p1</span><span class="p">.</span><span class="n">style</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">*</span> <span class="mi">2</span>

<span class="c1"># 设置页眉
</span><span class="n">header</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">header</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">header</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'Deep Forecast: Deep Learning-based Spatio-Temporal Forecasting'</span><span class="p">)</span>
<span class="n">header</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="n">new_doc</span><span class="p">.</span><span class="n">settings</span><span class="p">.</span><span class="n">odd_and_even_pages_header_footer</span> <span class="o">=</span> <span class="bp">True</span>
<span class="c1"># 设置偶数页页眉
</span><span class="n">section</span> <span class="o">=</span> <span class="n">new_doc</span><span class="p">.</span><span class="n">sections</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">even_page_header</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">even_page_header</span>  <span class="c1"># 获取偶数页
</span><span class="n">even_page_run</span> <span class="o">=</span> <span class="n">even_page_header</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">add_run</span><span class="p">(</span><span class="s">'Tech Blogs'</span><span class="p">)</span>
<span class="n">even_page_run</span><span class="p">.</span><span class="n">font</span><span class="p">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">Pt</span><span class="p">(</span><span class="mi">18</span><span class="p">)</span>  <span class="c1"># 设置偶数页页眉大小
</span><span class="n">even_page_header</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">RIGHT</span>

<span class="c1"># 设置页脚
# todo 不清楚如何添加页码
</span><span class="n">footer_page</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">footer</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">footer_page</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'Study hard and make progress everyday!'</span><span class="p">)</span>
<span class="n">footer_page</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>
<span class="n">even_page_footer_run</span> <span class="o">=</span> <span class="n">section</span><span class="p">.</span><span class="n">even_page_footer</span><span class="p">.</span><span class="n">paragraphs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">even_page_footer_run</span><span class="p">.</span><span class="n">add_run</span><span class="p">(</span><span class="s">'Knowledge is power'</span><span class="p">)</span>
<span class="n">even_page_footer_run</span><span class="p">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">WD_PARAGRAPH_ALIGNMENT</span><span class="p">.</span><span class="n">CENTER</span>

<span class="n">new_doc</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="s">"Tech Blogs v2.6.docx"</span><span class="p">)</span>
</pre></table></code></div></div><p>参考链接：</p><p>1.<a href="https://python-docx.readthedocs.io/en/latest/#user-guide"> python-docx — python-docx 0.8.11 documentation</a></p><p>2.<a href="https://blog.csdn.net/weixin_47383889/article/details/119847787">浅谈python-docx的缩进问题——如何缩进两个字符</a></p><p>3.<a href="https://baijiahao.baidu.com/s?id=1665454009794833226&amp;wfr=spider&amp;for=pc">python-docx设置页眉和页脚 (baidu.com)</a></p><p>4.<a href="https://blog.csdn.net/liaosen/article/details/121242200">利用python自动写Word文档（三）——用Python-docx修改表格</a></p><p>5.<a href="https://blog.csdn.net/xtfge0915/article/details/83480120">python-docx表格样式列表</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/python/'>Python</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python%E5%9F%BA%E6%93%8D/" class="post-tag no-text-decoration" >Python基操</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Python基操-自动化办公(Word) - Technical Blogs&url=https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Python基操-自动化办公(Word) - Technical Blogs&u=https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Python基操-自动化办公(Word) - Technical Blogs&url=https://carmanzheng.github.io//posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Word)/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Kubernetes%E6%A6%82%E8%BF%B0/">Kubernetes</a><li><a href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93-MySQL%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">MySQL存储引擎</a><li><a href="/posts/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a><li><a href="/posts/Python-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B/">Python基操-多进程与多线程</a><li><a href="/posts/%E5%89%8D%E7%AB%AF-Vue%E8%B7%AF%E7%94%B1%E4%B8%8EVuex/">前端 Vue路由与vuex</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/python%E5%9F%BA%E6%93%8D/">Python基操</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFjs/">前端JS</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFvue/">前端Vue</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFcss/">前端CSS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/linux%E5%9F%BA%E7%A1%80/">Linux基础</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFhtml/">前端HTML</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91/">客户端开发</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/python-os%E5%9F%BA%E6%93%8D/"><div class="card-body"> <em class="timeago small" date="2020-03-26 00:00:00 +0800" >2020-03-26</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python基操-os</h3><div class="text-muted small"><p> Python中OS模块对文件路径、文件夹、文件的操作 1.获取当前路径 os.getcwd() 2. 改变文件夹路径 os.chdir(path) 3. 获取文件夹下所有文件 os.listdir() 4. 生成文件夹和生成多层文件夹 mkdir() # Use for making one directory makedirs() # Use if you want to...</p></div></div></a></div><div class="card"> <a href="/posts/pyhton-datetime%E5%9F%BA%E6%93%8D/"><div class="card-body"> <em class="timeago small" date="2020-03-27 00:00:00 +0800" >2020-03-27</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python基操-datetime</h3><div class="text-muted small"><p> Python 中的datetime模块，时间获取、时间转换等常用的用法。 第一部分 总体概览 datetime是一个关于时间的库，主要包含的类有： 类名 功能说明 date 日期对象,常用的属性有year, month, day time 时间对...</p></div></div></a></div><div class="card"> <a href="/posts/Python-%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%9F%BA%E6%93%8D/"><div class="card-body"> <em class="timeago small" date="2020-03-28 00:00:00 +0800" >2020-03-28</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python基操-格式化基操</h3><div class="text-muted small"><p> Python在处理文字、数字等工程领域内的文字符号输出时，需要用到格式化内容。本文主要总结python中format的用法，足以满足输出的需要。 第一部分 python格式化 Python2.6 开始，新增了一种格式化字符串的函数 str.format()，它增强了字符串格式化的功能。基本语法是通过 {} 和 : 来代替以前的 %。format 函数可以接受不限个参数，位置可以不按顺序...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Python-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/" class="btn btn-outline-primary" prompt="上一篇"><p>Python基操-正则表达式</p></a> <a href="/posts/Python-%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC(Excel)/" class="btn btn-outline-primary" prompt="下一篇"><p>Python基操-自动化办公(Excel)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/carmanzheng">carmanzheng</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/python%E5%9F%BA%E6%93%8D/">Python基操</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFjs/">前端JS</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFvue/">前端Vue</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFcss/">前端CSS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/linux%E5%9F%BA%E7%A1%80/">Linux基础</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFhtml/">前端HTML</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91/">客户端开发</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
