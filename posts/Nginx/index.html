<!DOCTYPE html><html lang="zh-CN" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="天前"><meta name="hour-prompt" content="小时前"><meta name="minute-prompt" content="分钟前"><meta name="justnow-prompt" content="刚刚"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Nginx" /><meta property="og:locale" content="zh_CN" /><meta name="description" content="本文主要介绍Nginx内容，Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的，第一个公开版本0.1.0发布于2004年10月4日。" /><meta property="og:description" content="本文主要介绍Nginx内容，Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的，第一个公开版本0.1.0发布于2004年10月4日。" /><link rel="canonical" href="https://carmanzheng.github.io//posts/Nginx/" /><meta property="og:url" content="https://carmanzheng.github.io//posts/Nginx/" /><meta property="og:site_name" content="Technical Blogs" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-24T00:00:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Nginx" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"description":"本文主要介绍Nginx内容，Nginx (engine x) 是一个高性能的HTTP和反向代理web服务器，同时也提供了IMAP/POP3/SMTP服务。Nginx是由伊戈尔·赛索耶夫为俄罗斯访问量第二的Rambler.ru站点（俄文：Рамблер）开发的，第一个公开版本0.1.0发布于2004年10月4日。","headline":"Nginx","dateModified":"2022-03-07T10:11:56+08:00","datePublished":"2022-01-24T00:00:00+08:00","url":"https://carmanzheng.github.io//posts/Nginx/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://carmanzheng.github.io//posts/Nginx/"},"@context":"https://schema.org"}</script><title>Nginx | Technical Blogs</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Technical Blogs"><meta name="application-name" content="Technical Blogs"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="zh-CN"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/favicons/android-chrome-192x192.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Technical Blogs</a></div><div class="site-subtitle font-italic">Learning by Doing, Sharing for more!</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>首页</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>分类</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>标签</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>归档</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>关于</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Carmanzheng" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['zhengkan1993','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> 首页 </a> </span> <span>Nginx</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 文章</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="搜索..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >取消</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Nginx</h1><div class="post-meta text-muted"><div> 作者 <em> <a href="https://github.com/carmanzheng">carmanzheng</a> </em></div><div class="d-flex"><div> <span> 发表于 <em class="timeago" date="2022-01-24 00:00:00 +0800" data-toggle="tooltip" data-placement="bottom" title="2022-01-24, 00:00 +0800" >01-24</em> </span> <span> 更新于 <em class="timeago" date="2022-03-07 10:11:56 +0800 " data-toggle="tooltip" data-placement="bottom" title="2022-03-07, 10:11 +0800" >03-07</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="4569 字"> <em>25 分钟</em>阅读</span></div></div></div><div class="post-content"><p>本文主要介绍Nginx内容，<em>Nginx</em> (engine x) 是一个高性能的<a href="https://baike.baidu.com/item/HTTP">HTTP</a>和<a href="https://baike.baidu.com/item/反向代理/7793488">反向代理</a>web服务器，同时也提供了IMAP/POP3/SMTP服务。Nginx是由伊戈尔·赛索耶夫为<a href="https://baike.baidu.com/item/俄罗斯/125568">俄罗斯</a>访问量第二的Rambler.ru站点（俄文：Рамблер）开发的，第一个公开版本0.1.0发布于2004年10月4日。</p><p>它不仅是一个高性能的HTTP和反向代理服务器，同时也是一个IMAP/POP3/SMTP 代理服务器。</p><h3 id="1-简单应用">1. 简单应用<a href="#1-简单应用" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>一般会在docker中拉取镜像，后运行nginx就能看到服务</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># 1. 拉取镜像</span>
docker pull nginx
<span class="c"># 2. 运行nginx</span>
docker run <span class="nt">-d</span> <span class="nt">-p</span> 80:80 nginx
<span class="c"># 3.访问本地 https://localhost:80</span>
</pre></table></code></div></div><p><img data-src="../../assets/images/20220124nginx/image-20220228095847707.png" alt="image-20220228095847707" data-proofer-ignore></p><h3 id="2-部署vue项目">2. 部署vue项目<a href="#2-部署vue项目" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>本小节介绍简单的部署，即能够运行页面即可</p><h4 id="1打包移植">1.打包移植<a href="#1打包移植" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="c"># 在vue项目文件夹中，打包项目到dist文件夹</span>
npm run build 
<span class="c"># 将打包后的dist文件夹复制到nginx目录下，并创建Dockerfile，目录结构,</span>
nginx
   |---  dist 
   |---  Dockerfile
</pre></table></code></div></div><h4 id="2编写dockerfile">2.编写Dockerfile<a href="#2编写dockerfile" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p><code class="language-plaintext highlighter-rouge">Dockerfile</code></p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> nginx:latest</span>
<span class="k">MAINTAINER</span><span class="s"> ZHENG</span>
<span class="k">COPY</span><span class="s"> dist/ /usr/share/nginx/html/</span>
</pre></table></code></div></div><h4 id="3构建镜像并运行">3.构建镜像并运行<a href="#3构建镜像并运行" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c"># 在nginx的cmd下，构建镜像</span>
docker build <span class="nt">-t</span> <span class="nb">test</span> <span class="nb">.</span>
<span class="c"># 生成容器</span>
docker run <span class="nt">-p</span> 3000:80 <span class="nt">-d</span> <span class="nt">--name</span> <span class="nb">test </span>mytest
</pre></table></code></div></div><h4 id="4访问端口">4.访问端口<a href="#4访问端口" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>访问 <code class="language-plaintext highlighter-rouge">https://localhost:3000</code>，可以访问到<code class="language-plaintext highlighter-rouge">/usr/share/nginx/html/</code>下的静态网页。如果需要数据是动态与后端交互的，还要阅读下面的内容哦 ~</p><h3 id="3-部署flask项目">3. 部署flask项目<a href="#3-部署flask项目" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="1-配置guinicorn">1. 配置<code class="language-plaintext highlighter-rouge">guinicorn</code><a href="#1-配置guinicorn" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p><code class="language-plaintext highlighter-rouge">gunicorn</code>是一个unix上被广泛使用的高性能的Python WSGI UNIX HTTP Server。和大多数的web框架兼容，并具有实现简单，轻量级，高性能等特点。</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># 安装 gunicorn</span>
pip <span class="nb">install </span>gunicorn
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
</pre><td class="rouge-code"><pre><span class="c"># gunicorn配置详解</span>
<span class="c"># server socket</span>
<span class="c"># bind   监听地址和端口。</span>
<span class="nb">bind</span> <span class="o">=</span> <span class="s1">'127.0.0.1:8000'</span>     

<span class="c"># backlog</span>
<span class="c"># 服务器中在pending状态的最大连接数，即client处于waiting的数目。超过这个数目， client连接会得到一个error。</span>
<span class="c"># 建议值64-2048。</span>
backlog <span class="o">=</span> 512                <span class="c">#监听队列</span>
<span class="c"># workers</span>
<span class="c"># worker进程的数量。建议值2-4 x $(NUM_CORES)， 缺省为1。</span>
workers <span class="o">=</span> 3

<span class="c"># worker_class</span>
<span class="c"># worker进程的工作方式。 有 sync, eventlet, gevent, tornado, gthread, 缺省值sync。</span>

threads
工作进程中线程的数量。建议值2-4 x <span class="si">$(</span>NUM_CORES<span class="si">)</span>， 缺省值1。
此配置只适用于gthread 进程工作方式， 因为gevent这种使用的是协程工作方式。

worker_connections
客户端最大同时连接数。只适用于eventlet， gevent工作方式。

<span class="c"># max_requests</span>
<span class="c"># worker重启之前处理的最大requests数， 缺省值为0表示自动重启disabled。主要是防止内存泄露。</span>
max_requests <span class="o">=</span>1000

max_requests_jitter
抖动参数，防止worker全部同时重启。

<span class="nb">timeout
</span>通常设为30。

graceful_timeout
接收到restart信号后，worker可以在graceful_timeout时间内，继续处理完当前requests。

keepalive
server端保持连接时间

security
limit_request_line
http request line最大字节数。值范围0-8190， 0表示无限制。

limit_request_field
http request中 header字段数的最大值。缺省为100，最大32768。

limit_request_field_size
http request header字段最大字节数。0表示无限制。

调试
reload
当代码有修改时，自动重启workers。适用于开发环境。

reload_extra_files
扩展reload配置，增加templates，configurations等文件修改监控。

spew
跟踪程序执行的每一行。

check_config
检查配置。

server 机制
sendfile
系统底层拷贝数据方式，提供performance。

chdir
在app加载之前，进入到此目录。

daemon
应用是否以daemon方式运行。

raw_env
<span class="nv">key</span><span class="o">=</span>value, 传递环境参数。

pidfile
pid存储文件路径。

worker_tmp_dir
临时工作目录。

user
指定worker进程的运行用户名。

group
指定worker进程运行用户所在组。

<span class="nb">umask
</span>gunicorn创建文件的缺省权限。

pythonpath
附加到python path的目录列表。

日志
accesslog
访问日志文件路径。

access_log_format
日志格式。 例如 %<span class="o">(</span>h<span class="o">)</span>s %<span class="o">(</span>l<span class="o">)</span>s %<span class="o">(</span>u<span class="o">)</span>s %<span class="o">(</span>t<span class="o">)</span>s <span class="s2">"%(r)s"</span> %<span class="o">(</span>s<span class="o">)</span>s %<span class="o">(</span>b<span class="o">)</span>s <span class="s2">"%(f)s"</span> <span class="s2">"%(a)s"</span> 。

errorlog
错误日志路径。

loglever
日志级别。debug, info, warning, error, critical.

capture_output
重定向stdout/stderr到error log file。

logger_class
日志实现类。缺省gunicorn.glogging.Logger 。

logconfig
日志配置文件。同python标准日志模块logging的配置。

进程名
proc_name
设置进程名<span class="o">(</span>setproctitle<span class="o">)</span>，在ps，top等命令中会看到. 缺省值为default_proc_name配置。
server钩子
on_starting
on_reload
when_ready
pre_fork
post_fork
post_worker_init
worker_init
worker_abort
pre_exec
pre_request
post_request
child_exit
worker-exit
nworkers_changed
on_exit

作者：慢手暗夜
链接：https://www.jianshu.com/p/69e75fc3e08e
来源：简书
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。
</pre></table></code></div></div><p>文件目录</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>app_pro
	|--- app_real.py
	|--- deploy.py
	|--- requirements.txt
	|--- Dockerfile
</pre></table></code></div></div><p>基本配置一个<code class="language-plaintext highlighter-rouge">deploy.py</code></p><p><code class="language-plaintext highlighter-rouge">guni.conf.py</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>import os
<span class="nb">bind</span><span class="o">=</span><span class="s1">'0.0.0.0:5001'</span>   <span class="c">#绑定监听ip和端口号</span>
<span class="nv">workers</span><span class="o">=</span>3               <span class="c">#同时执行的进程数，推荐为当前CPU个数*2+1</span>
<span class="nv">threads</span><span class="o">=</span>4				<span class="c"># 指定每个CPU的线程数</span>
<span class="c">#backlog=2048            #等待服务客户的数量，最大为2048，即最大挂起的连接数</span>
<span class="c">#worker_class="gevent" #sync, gevent,meinheld   #工作模式选择，默认为sync，这里设定为gevent异步</span>
worker_class <span class="o">=</span> <span class="s1">'gevent'</span>
<span class="c">#max_requests=1000       #默认的最大客户端并发数量</span>
<span class="nv">daemon</span><span class="o">=</span>True           <span class="c"># 是否后台运行</span>
<span class="nv">reload</span><span class="o">=</span>True            <span class="c"># 当代码有修改时，自动重启workers。适用于开发环境。</span>
loglevel <span class="o">=</span> <span class="s1">'info'</span>		<span class="c"># 设置日志记录水平</span>
</pre></table></code></div></div><h4 id="2-编写dockerfile">2. 编写Dockerfile<a href="#2-编写dockerfile" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p><code class="language-plaintext highlighter-rouge">Dockerfile</code></p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> python:3.8</span>
<span class="k">MAINTAINER</span><span class="s"> ZHENGKAN</span>
<span class="k">WORKDIR</span><span class="s"> usr/src/flask_app</span>
<span class="k">COPY</span><span class="s"> requirements.txt .</span>
<span class="k">RUN </span>pip <span class="nb">install</span> <span class="nt">--upgrade</span> pip <span class="nt">-i</span> https://pypi.doubanio.com/simple/
<span class="k">RUN </span>pip <span class="nb">install</span> <span class="nt">--no-cache-dir</span> <span class="nt">-r</span> requirements.txt <span class="nt">-i</span> https://pypi.doubanio.com/simple/
<span class="k">COPY</span><span class="s"> . .</span>
<span class="c"># 注意app_real为flask的入口主文件 后面的app是主文件内部的一个flask实例对象</span>
<span class="k">CMD</span><span class="s"> gunicorn -c  guni.conf.py  app_real:app --preload</span>
</pre></table></code></div></div><h4 id="3-构建镜像并运行">3. 构建镜像并运行<a href="#3-构建镜像并运行" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>docker build <span class="nt">-t</span> test01 <span class="nb">.</span>
docker run <span class="nt">-d</span> <span class="nt">-p</span> 8888:5001 <span class="nt">--name</span> flask_app test01   <span class="c"># 将内部5001端口映射到宿主机的8888端口</span>
</pre></table></code></div></div><h4 id="4-访问端口">4. 访问端口<a href="#4-访问端口" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>访问 <code class="language-plaintext highlighter-rouge">https://localhost:8888</code></p><h3 id="4部署mysql项目">4.部署mysql项目<a href="#4部署mysql项目" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><h4 id="1拉取mysql镜像">1.拉取mysql镜像<a href="#1拉取mysql镜像" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>docker pull mysql:8.0
</pre></table></code></div></div><h4 id="2配置docker-compose文件">2.配置docker-compose文件<a href="#2配置docker-compose文件" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>对于mysql，由于配置项较多，这时候考虑使用<code class="language-plaintext highlighter-rouge">docker-compose</code>来部署</p><p>配置文件结构</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>app
 | <span class="nt">---</span> docker-compose.yml
 | <span class="nt">---</span> mysql
 		| <span class="nt">---</span> config
 				| <span class="nt">---</span> mysqld.cnf
 		| <span class="nt">---</span> data
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">docker-compose.yml</code></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3.7"</span>
<span class="na">services</span><span class="pi">:</span>
  <span class="na">myisql</span><span class="pi">:</span>
  <span class="c1"># container_name: mysql_app</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mysql:8.0</span>                            <span class="c1">#从私有仓库拉镜像-stopp</span>
    <span class="na">command</span><span class="pi">:</span> 
<span class="err">    		</span><span class="s">--authentication_policy=mysql_native_password</span> <span class="c1">#这行代码解决无法访问的问题</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">./mysql/data/:/var/lib/mysql/</span>                            <span class="c1">#映射mysql的数据目录到宿主机，保存数据</span>
      <span class="pi">-</span> <span class="s">./mysql/config/mysqld.cnf:/etc/mysql/mysql.conf.d/mysqld.cnf</span>   <span class="c1">#把mysql的配置文件映射到容器的相应目录</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">unless-stopped</span><span class="err">		</span><span class="s"># docker的重启策略：在容器退出时总是重启容器，但是不考虑在Docker守护进程启动时就已经停止了的容器</span>
    <span class="na">ports</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="s2">"</span><span class="s">3305:3306"</span>
    <span class="na">environment</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=123</span>
      <span class="pi">-</span> <span class="s">MYSQL_USER=zheng</span>
      <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=123</span>
      <span class="pi">-</span> <span class="s">MYSQL_DATABASE=yourdbname</span>
      <span class="pi">-</span> <span class="s">LANG=C.UTF-8</span>
      <span class="pi">-</span> <span class="s">TZ=Asia/Shanghai</span>
</pre></table></code></div></div><h4 id="3构建容器服务并访问">3.构建容器服务并访问<a href="#3构建容器服务并访问" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>docker-compose <span class="nt">-d</span> up 
<span class="c"># 此过程需要等待时间，mysql需要初始化配置</span>
</pre></table></code></div></div><h4 id="4navicat访问一下">4.Navicat访问一下<a href="#4navicat访问一下" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p><img data-src="../../assets/images/20220124nginx/image-20220301172404412.png" alt="image-20220301172404412" data-proofer-ignore></p><p>其数据库挂载卷在<code class="language-plaintext highlighter-rouge">./mysql/data/</code>下</p><h3 id="5综合部署">5.综合部署<a href="#5综合部署" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>BigScreen
  |--- docker-compose.yml
  |--- flask_app
  |		|--- app_real.py
  |		|--- guni.conf.py
  |		|--- reqirements.txt
  |		|--- Dockerfile
  |		|--- ...
  |--- mysql
  |		|--- config
  |		|		|--- mysqld.cnf<span class="o">(</span>空文件夹，可配置<span class="o">)</span>
  |		|--- data（空文件夹，用来存储mysql数据）
  |		|--- init
  |				|--- init.sql
  |--- nginx
  		|--- config 
  		|		|---nginx.conf
  		|--- dist <span class="o">(</span>vue打包的文件<span class="o">)</span>
  		|--- Dockerfile
  		
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">docker-compose.yml</code></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3.7"</span>
<span class="na">services</span><span class="pi">:</span>
    <span class="na">flask_app</span><span class="pi">:</span>
      <span class="na">build</span><span class="pi">:</span>
        <span class="na">context</span><span class="pi">:</span> <span class="s">flask_app</span>
        <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">flask_app:1.0</span>
      <span class="na">ports</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s2">"</span><span class="s">9000:9000"</span>
      <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>
      <span class="na">depends_on</span><span class="pi">:</span> 
          <span class="pi">-</span> <span class="s2">"</span><span class="s">mysql"</span>
      <span class="na">network_mode</span><span class="pi">:</span> <span class="s">host</span>
    <span class="na">nginx</span><span class="pi">:</span>
      <span class="na">build</span><span class="pi">:</span>
        <span class="na">context</span><span class="pi">:</span> <span class="s">nginx</span>
        <span class="na">dockerfile</span><span class="pi">:</span> <span class="s">Dockerfile</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">vue</span>
      <span class="na">ports</span><span class="pi">:</span>
         <span class="pi">-</span> <span class="s2">"</span><span class="s">80:80"</span>
      <span class="na">network_mode</span><span class="pi">:</span> <span class="s">host</span>
    <span class="na">mysql</span><span class="pi">:</span>
      <span class="na">container_name</span><span class="pi">:</span> <span class="s">mysql</span>
      <span class="na">image</span><span class="pi">:</span> <span class="s">mysql:8.0</span>                            <span class="c1">#从私有仓库拉镜像</span>
      <span class="na">restart</span><span class="pi">:</span> <span class="s">always</span>     
      <span class="na">command</span><span class="pi">:</span> <span class="s">--default-authentication-plugin=mysql_native_password</span> <span class="c1">#这行代码解决无法访问的问题</span>
      <span class="na">volumes</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">./mysql/data/:/var/lib/mysql/</span>                            <span class="c1">#映射mysql的数据目录到宿主机，保存数据</span>
        <span class="pi">-</span> <span class="s">./mysql/config/mysqld.cnf:/etc/mysql/mysql.conf.d/mysqld.cnf</span>   <span class="c1">#把mysql的配置文件映射到容器的相应目录</span>
      <span class="na">ports</span><span class="pi">:</span>  
        <span class="pi">-</span> <span class="s2">"</span><span class="s">3305:3306"</span>
      <span class="na">environment</span><span class="pi">:</span>
       <span class="pi">-</span> <span class="s">MYSQL_USER=zheng</span>
       <span class="pi">-</span> <span class="s">MYSQL_PASSWORD=123</span>
       <span class="pi">-</span> <span class="s">LANG=C.UTF-8</span>
       <span class="pi">-</span> <span class="s">TZ=Asia/Shanghai</span>
       <span class="pi">-</span> <span class="s">MYSQL_ROOT_PASSWORD=123</span>
       <span class="pi">-</span> <span class="s">MYSQL_DATABASE=LabDatabase</span> 
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">flask_app/Dockerfile</code></p><div class="language-dockerfile highlighter-rouge"><div class="code-header"> <span label-text="Dockerfile"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">FROM</span><span class="s"> python:3.8</span>
<span class="k">MAINTAINER</span><span class="s"> ZHENGKAN</span>
<span class="k">RUN </span>/bin/cp /usr/share/zoneinfo/Asia/Shanghai /etc/localtime <span class="o">&amp;&amp;</span> <span class="nb">echo</span> <span class="s1">'Asia/Shanghai'</span> <span class="o">&gt;</span>/etc/timezone
<span class="k">WORKDIR</span><span class="s"> usr/src/flask_app</span>
<span class="k">COPY</span><span class="s"> requirements.txt .</span>
<span class="k">RUN </span>pip <span class="nb">install</span>  <span class="nt">-r</span> requirements.txt <span class="nt">-i</span> https://pypi.doubanio.com/simple/
<span class="k">COPY</span><span class="s"> . .</span>
<span class="c"># 注意app_real为flask的入口主文件 后面的app是主文件内部的一个flask实例对象</span>
<span class="k">CMD</span><span class="s"> gunicorn -c  guni.conf.py  app_real:app --preload</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">mysql/init/init.sql</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="c"># 这个文件可以创建初始的表格，写sql语句就行，暂时不配置</span>
<span class="c"># 具体的用户和库的配置在yml文件的environment中已经配置</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">nginx/config/nginx.conf</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
</pre><td class="rouge-code"><pre><span class="c">#user  nobody;</span>
worker_processes  1<span class="p">;</span>

<span class="c">#error_log  logs/error.log;</span>
<span class="c">#error_log  logs/error.log  notice;</span>
<span class="c">#error_log  logs/error.log  info;</span>

<span class="c">#pid        logs/nginx.pid;</span>


events <span class="o">{</span>
    worker_connections  1024<span class="p">;</span>
<span class="o">}</span>


http <span class="o">{</span>
    include       mime.types<span class="p">;</span>
    default_type  application/octet-stream<span class="p">;</span>

    <span class="c">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
    <span class="c">#                  '$status $body_bytes_sent "$http_referer" '</span>
    <span class="c">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span>

    <span class="c">#access_log  logs/access.log  main;</span>

    sendfile        on<span class="p">;</span>
    <span class="c">#tcp_nopush     on;</span>

    <span class="c">#keepalive_timeout  0;</span>
    keepalive_timeout  65<span class="p">;</span>

    <span class="c">#gzip  on;</span>

    server <span class="o">{</span>
        listen       80<span class="p">;</span>
        server_name  localhost<span class="p">;</span>

        <span class="c">#charset koi8-r;</span>

        <span class="c">#access_log  logs/host.access.log  main;</span>

        location / <span class="o">{</span>
            root  /usr/share/nginx/html<span class="p">;</span>
	        try_files <span class="nv">$uri</span> /index.html    last<span class="p">;</span>
            index  index.html index.htm<span class="p">;</span>
        <span class="o">}</span>

        <span class="c">#error_page  404              /404.html;</span>

        <span class="c"># redirect server error pages to the static page /50x.html</span>
        <span class="c">#</span>
        error_page   500 502 503 504  /50x.html<span class="p">;</span>
        location <span class="o">=</span> /50x.html <span class="o">{</span>
		
            root   html<span class="p">;</span>
        <span class="o">}</span>

        <span class="c"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span>
        <span class="c">#</span>
        location /api/ <span class="o">{</span>
        <span class="c"># 就这一下，后面加个斜杠,配置后端接口; 上面/api/后面有斜杠，下面的代理地址也要加斜杠，细节！！</span>
            proxy_pass   http://127.0.0.1:9000/<span class="p">;</span>
        <span class="o">}</span>

        <span class="c"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span>
        <span class="c">#</span>
        <span class="c">#location ~ \.php$ {</span>
        <span class="c">#    root           html;</span>
        <span class="c">#    fastcgi_pass   127.0.0.1:9000;</span>
        <span class="c">#    fastcgi_index  index.php;</span>
        <span class="c">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span>
        <span class="c">#    include        fastcgi_params;</span>
        <span class="c">#}</span>

        <span class="c"># deny access to .htaccess files, if Apache's document root</span>
        <span class="c"># concurs with nginx's one</span>
        <span class="c">#</span>
        <span class="c">#location ~ /\.ht {</span>
        <span class="c">#    deny  all;</span>
        <span class="c">#}</span>
    <span class="o">}</span>


    <span class="c"># another virtual host using mix of IP-, name-, and port-based configuration</span>
    <span class="c">#</span>
    <span class="c">#server {</span>
    <span class="c">#    listen       8000;</span>
    <span class="c">#    listen       somename:8080;</span>
    <span class="c">#    server_name  somename  alias  another.alias;</span>

    <span class="c">#    location / {</span>
    <span class="c">#        root   html;</span>
    <span class="c">#        index  index.html index.htm;</span>
    <span class="c">#    }</span>
    <span class="c">#}</span>


    <span class="c"># HTTPS server</span>
    <span class="c">#</span>
    <span class="c">#server {</span>
    <span class="c">#    listen       443 ssl;</span>
    <span class="c">#    server_name  localhost;</span>

    <span class="c">#    ssl_certificate      cert.pem;</span>
    <span class="c">#    ssl_certificate_key  cert.key;</span>

    <span class="c">#    ssl_session_cache    shared:SSL:1m;</span>
    <span class="c">#    ssl_session_timeout  5m;</span>

    <span class="c">#    ssl_ciphers  HIGH:!aNULL:!MD5;</span>
    <span class="c">#    ssl_prefer_server_ciphers  on;</span>

    <span class="c">#    location / {</span>
    <span class="c">#        root   html;</span>
    <span class="c">#        index  index.html index.htm;</span>
    <span class="c">#    }</span>
    <span class="c">#}</span>

<span class="o">}</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">nginx/Dockerfile</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>FROM nginx
<span class="c"># 定义作者</span>
MAINTAINER ZHENGKAN
<span class="c"># 将dist文件中的内容复制到 /usr/share/nginx/html/ 这个目录下面</span>
COPY dist/  /usr/share/nginx/html/
COPY config/nginx.conf /etc/nginx/nginx.conf

EXPOSE 80
RUN <span class="nb">echo</span> <span class="s1">'echo init ok!!'</span>
</pre></table></code></div></div><h3 id="6nginxconf配置详解">6.nginx.conf配置详解<a href="#6nginxconf配置详解" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><code class="language-plaintext highlighter-rouge">conf/nginx.conf</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
</pre><td class="rouge-code"><pre><span class="c">## 基本配置</span>
user 							<span class="c"># 设置nginx服务的系统使用用户,通常注释掉</span>
worker_processes 	2			 <span class="c"># 工作进程数，一般与cpu核心数保持一致</span>
error_log						<span class="c"># nginx的错误日志，这个后面写目录，用于存放错误日志；日志级别 [debug | info | notice | warn | error | crit]，								#  默认是error</span>

<span class="c"># error_log logs/error.log;</span>
<span class="c"># erroe_log  logs/notice.log notice;</span>
<span class="c"># erroe_log  logs/info.log info;</span>

pid	logs/nginx.pid				<span class="c"># nginx服务启动时候的pid,一般不用改</span>

<span class="c">## 配置工作模式和连接数</span>
events
	<span class="o">{</span>
		worker_connections    1024  <span class="c"># 配置每个worker的最大连接数，nginx的总连接数就是 worker_processes * worker_connections = 2 *1024 = 2048</span>
							      <span class="c"># worker_connections的上限是 65535			</span>
     <span class="o">}</span>
<span class="c">## 配置http服务器，可以通过该部分配置进行反向代理、负载均衡</span>
http
	<span class="o">{</span> 							
        include 	mime.types<span class="p">;</span>		 <span class="c"># 在conf/mime.types文件中配置nginx支持的多媒体类型</span>
        default_type  application/octet-stream<span class="p">;</span> <span class="c"># 默认文件类型为流类型，可以理解为支持任意类型</span>

        <span class="c"># 配置日志格式，开启之后只要访问http，都会有记录，记录保存在logs/access.log文件中</span>
        <span class="c">#log_format  main  '$remote_addr - $remote_user [$time_local] "$request" '</span>
        <span class="c">#                  '$status $body_bytes_sent "$http_referer" '</span>
        <span class="c">#                  '"$http_user_agent" "$http_x_forwarded_for"';</span>

        <span class="c">#access_log  logs/access.log  main;</span>
	    <span class="c">#tcp_nopush     on;      # 防止网路阻塞</span>
        <span class="c">#keepalive_timeout  0;</span>
	    keepalive_timeout  65<span class="p">;</span>  <span class="c"># 长时间超时时间，单位为秒</span>

    	<span class="c">#gzip  on;</span>



        <span class="c"># 配置虚拟主机server，http下可以配置多个server</span>
        server <span class="o">{</span>				    <span class="c"># server配置每个站点的信息		</span>
            listen 80<span class="p">;</span> 				<span class="c"># 开放80端口供外部访问</span>
            server_name localhost<span class="p">;</span>	 <span class="c"># 配置外部访问nginx端口的域名，如 www.baidu.com</span>
            <span class="c">#charset koi8-r;		# 字符集</span>

            <span class="c">#access_log  logs/host.access.log  main;		# 配置本虚拟主机的访问日志</span>
            location / <span class="o">{</span>			<span class="c"># 访问域名下 / 的信息 http://www.baidu.com 的信息，即根路径</span>
            	root html<span class="p">;</span>          <span class="c"># root表示本地磁盘根路径，默认nginx安装的主目录为html文件夹 </span>
            	try_files <span class="nv">$uri</span> /index.html last<span class="p">;</span>
       		    index index.html index.htm<span class="p">;</span>

				<span class="o">}</span>
				
	
             <span class="c">#error_page  404              /404.html;  配置404页面</span>

            <span class="c"># redirect server error pages to the static page /50x.html</span>
            <span class="c">#</span>
            error_page   500 502 503 504  /50x.html<span class="p">;</span>
            <span class="c"># 精准匹配，当有/50x.html的匹配时，直接到html文件夹下，配置50x错误页面</span>
            location <span class="o">=</span> /50x.html <span class="o">{</span>
                root   html<span class="p">;</span>
        	<span class="o">}</span>
    
    
	<span class="o">}</span>
</pre></table></code></div></div><h4 id="1-静态网站部署">1. 静态网站部署<a href="#1-静态网站部署" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>vue写的项目，直接打包为dist后，将dist文件夹中的内容复制到html下，配置主要部分如下就行（其他默认）</p><p><code class="language-plaintext highlighter-rouge">nginx.conf</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>http
	<span class="o">{</span>
       ... 
        <span class="c"># 配置虚拟主机server，http下可以配置多个server</span>
        server <span class="o">{</span>				    <span class="c"># server配置每个站点的信息		</span>
            listen 80<span class="p">;</span> 				<span class="c"># 开放80端口供外部访问</span>
            server_name localhost<span class="p">;</span>	 <span class="c"># 配置外部访问nginx端口的域名，如 www.baidu.com</span>
            <span class="c">#charset koi8-r;		# 字符集</span>

            <span class="c">#access_log  logs/host.access.log  main;		# 配置本虚拟主机的访问日志</span>
            location / <span class="o">{</span>			<span class="c"># 访问域名下 / 的信息 http://www.baidu.com 的信息，即根路径</span>
            	root html<span class="p">;</span>          <span class="c"># root表示本地磁盘根路径，默认nginx安装的主目录为html文件夹 </span>
            	try_files <span class="nv">$uri</span> /index.html last<span class="p">;</span>
       		    index index.html index.htm<span class="p">;</span>
				<span class="o">}</span>
	<span class="o">}</span>
</pre></table></code></div></div><h4 id="2-负载均衡">2. 负载均衡<a href="#2-负载均衡" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>负载均衡有四种策略：轮询策略、权重策略、最少连接策略和ip_hash 策略</p><p><code class="language-plaintext highlighter-rouge">nginx.conf</code></p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>http
<span class="o">{</span>
	... 
	
    upstream app_server <span class="o">{</span> <span class="c"># 这个back_server命名随意，但是与下面的代理地址相同</span>
    
    <span class="c"># 轮询（默认）策略，这样服务器会被轮询访问，这个对硬件要求需要保持机器的性能一致，不然会导致请求堆积</span>
    server 192.168.31.21:8080   <span class="c"># 代理服务器地址</span>
    server 192.168.31.22:8080
    
    <span class="c"># 权重策略，如果配置权重，可以写成如下</span>
    <span class="c"># server 192.168.31.21:8080  weight = 1; # 在代理服务器地址后面设置权重weight，权重越大，访问比例越大；用于机器性能不一致的情况</span>
    <span class="c"># server 192.168.31.22:8080  weight = 2;</span>
    
    <span class="c"># 最少连接策略,哪个服务器连接数少，就给哪个服务器分配下一个请求任务</span>
    <span class="c"># less_conn;</span>
    <span class="c"># server 192.168.31.21:8080   # 代理服务器地址</span>
    <span class="c"># server 192.168.31.22:8080</span>
    
    <span class="c"># ip_hash策略，对ip地址做hash运算取模，根据模的数据选择服务器，这个容易造成单一服务器过载宕机,优点是不会丢失session</span>
    <span class="c"># ip_hash</span>
    <span class="c"># server 192.168.31.21:8080</span>
    <span class="c"># server 192.168.31.22:8080</span>
    <span class="o">}</span>
	
	server <span class="o">{</span>
		listen 80<span class="p">;</span>
		serer_name localhost<span class="p">;</span>
		
		...
		location /myweb <span class="o">{</span>
			proxy_pass http://app_server<span class="p">;</span>    <span class="c"># http://后面的名字与upstream后面的名字保持一致</span>
		<span class="o">}</span>
		... 	
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>备份服务器，备份服务器的存在是为了更新时候，服务不受影响</p><p>一般更新代码步骤：1. 更新备份服务器代码 2. 关掉一般服务器，并更新代码 3. 关闭另一半服务器，更新代码；</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>upstream back_server<span class="o">{</span>
	server 127.0.0.1:9100<span class="p">;</span>
	<span class="c"># 设置备份服务器，其他所有非backup机器down的时候，才请求backup机器</span>
	server 127.0.0.1:9200 backup<span class="p">;</span>
<span class="o">}</span>
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>upstream back_server<span class="o">{</span>
	server 127.0.0.1:9100<span class="p">;</span>
	<span class="c"># down表示当前server是down的状态，不参与负载均衡</span>
	server 127.0.0.1:9200 down<span class="p">;</span>
<span class="o">}</span>
</pre></table></code></div></div><h4 id="3-静态代理">3. 静态代理<a href="#3-静态代理" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre>http<span class="o">{</span>
    upstream app_server <span class="o">{</span> <span class="c"># 这个back_server命名随意，但是与下面的代理地址相同</span>
    server 192.168.31.21:8080   <span class="c"># 代理服务器地址</span>
    server 192.168.31.22:8080
    <span class="o">}</span>
    
	server <span class="o">{</span>
		listen 80<span class="p">;</span>
		serer_name localhost<span class="p">;</span>
		
		...
		location /myweb <span class="o">{</span>
			proxy_pass http://app_server<span class="p">;</span>    <span class="c"># http://后面的名字与upstream后面的名字保持一致</span>
		<span class="o">}</span>
		
		<span class="c"># ~ 表示正则匹配，也是后面的内容可以使用正则表达式匹配</span>
		<span class="c"># . 表示任意字符</span>
		<span class="c"># * 表示多个字符</span>
		<span class="c"># / 表示文件路径</span>
		<span class="c"># (css|js...)配合表示拦截到/css或/js路径</span>
		location ~ .<span class="k">*</span>/<span class="o">(</span>css|js|img|images|image<span class="o">){</span>
			root /opt/static<span class="p">;</span>
		<span class="o">}</span>
		... 	
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><h4 id="4-动静分离">4. 动静分离<a href="#4-动静分离" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>Nginx的负载均衡和静态代理进行结合，可以实现动静分离。</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>upstream www.p2p.com<span class="o">{</span>
	server 192.168.115.128:8081
	server 192.168.115.128:8082
<span class="o">}</span>

upstream static.p2p.com<span class="o">{</span>
	server 192.168.115.128:81
	server 192.168.115.128:82
<span class="o">}</span>

server<span class="o">{</span>
	listen 80<span class="p">;</span>
	server_name localhost<span class="p">;</span>
	
	location / <span class="o">{</span>
		root html<span class="p">;</span>
		index index.html index.htm<span class="p">;</span>
	<span class="o">}</span>
	
	<span class="c"># 负载均衡</span>
	location /p2p<span class="o">{</span>
		proxy_pass http://www.p2p.com<span class="p">;</span>
	<span class="o">}</span>
	
	<span class="c"># 动静分离</span>
	location ~ .<span class="k">*</span>/<span class="o">(</span>css|js|img|images<span class="o">)</span> <span class="o">{</span>
		proxy_pass http://static.p2p.com<span class="p">;</span>
	<span class="o">}</span>
	
	
<span class="o">}</span>
</pre></table></code></div></div><h4 id="5虚拟主机">5.虚拟主机<a href="#5虚拟主机" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>虚拟主机的情况下，访问同一地址，能够访问不同的主机。</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="已复制！"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
</pre><td class="rouge-code"><pre>upstream beijing.myweb.com<span class="o">{</span>
	server 192.168.115.128:8081<span class="p">;</span>  <span class="c"># 实际情况是这个地址为北京的ip；这里写成本地ip，需要修改本地的hosts文件地址达到访问的目的</span>
<span class="o">}</span>

upstream tianjin.myweb.com<span class="o">{</span>
	server 192.168.115.128:8082<span class="p">;</span>
<span class="o">}</span>

upstream nanjing.myweb.com<span class="o">{</span>
	server 192.168.115.128:8083<span class="p">;</span>
<span class="o">}</span>

server<span class="o">{</span>
	listen 80<span class="p">;</span>
	server_name beijing.myweb.com<span class="p">;</span>          <span class="c">#访问beijing.myweb.com,请求被反向代理到192.168.115.128:8081服务器</span>
	location / <span class="o">{</span>
		proxy_pass http:beijing.myweb.com<span class="p">;</span>
	<span class="o">}</span>
<span class="o">}</span>

server<span class="o">{</span>
	listen 80<span class="p">;</span>
	server_name tianjin.myweb.com<span class="p">;</span>
	location / <span class="o">{</span>
		proxy_pass http:tianjin.myweb.com<span class="p">;</span>
	<span class="o">}</span>
<span class="o">}</span>

server<span class="o">{</span>
	listen 80<span class="p">;</span>
	server_name nanjing.myweb.com<span class="p">;</span>
	location / <span class="o">{</span>
		proxy_pass http:nanjing.myweb.com<span class="p">;</span>
	<span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>参考链接：</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/it/'>IT</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/devops/" class="post-tag no-text-decoration" >DevOps</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 本文由作者按照 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 进行授权</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">分享</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nginx - Technical Blogs&url=https://carmanzheng.github.io//posts/Nginx/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nginx - Technical Blogs&u=https://carmanzheng.github.io//posts/Nginx/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Nginx - Technical Blogs&url=https://carmanzheng.github.io//posts/Nginx/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="分享链接" title-succeed="链接已复制！"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">最近更新</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Kubernetes%E6%A6%82%E8%BF%B0/">Kubernetes</a><li><a href="/posts/%E6%95%B0%E6%8D%AE%E5%BA%93-MySQL%E7%B4%A2%E5%BC%95%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">MySQL存储引擎</a><li><a href="/posts/Linux%E5%9F%BA%E7%A1%80/">Linux基础</a><li><a href="/posts/Python-%E5%A4%9A%E8%BF%9B%E7%A8%8B%E5%A4%9A%E7%BA%BF%E7%A8%8B/">Python基操-多进程与多线程</a><li><a href="/posts/%E5%89%8D%E7%AB%AF-Vue%E8%B7%AF%E7%94%B1%E4%B8%8EVuex/">前端 Vue路由与vuex</a></ul></div><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/python%E5%9F%BA%E6%93%8D/">Python基操</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFjs/">前端JS</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFvue/">前端Vue</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFcss/">前端CSS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/linux%E5%9F%BA%E7%A1%80/">Linux基础</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFhtml/">前端HTML</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91/">客户端开发</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">文章内容</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>相关文章</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/docker%E5%9F%BA%E7%A1%80/"><div class="card-body"> <em class="timeago small" date="2022-02-15 00:00:00 +0800" >02-15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker基础</h3><div class="text-muted small"><p> 本文主要对docker的基础知识进行介绍，了解docker的镜像、容器和仓库。 1.镜像 docker的镜像实由一层一层的文件系统组成，这种层级的文件系统采用联合文件系统编写（UnionFS)，优点：共享资源。 即有多个镜像从相同的base镜像构建而来，那么宿主机上只需要在磁盘上保存一份base镜像，同时内存中只需要加载一份base镜像，就可以为所有容器提供服务了，且镜像的每一层都能被...</p></div></div></a></div><div class="card"> <a href="/posts/Docker-Compose-%E7%A9%BA/"><div class="card-body"> <em class="timeago small" date="2022-02-16 00:00:00 +0800" >02-16</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Docker-Compose</h3><div class="text-muted small"><p> 1. Docker Compose简介 ​ Docker Compose是一个用来定义和运行复杂应用的Docker工具。一个使用Docker容器的应用，通常由多个容器组成。使用Docker Compose不再需要使用shell脚本来启动容器。 ​ Docker Compose 通过一个配置文件（yml文件）来管理多个Docker容器，在配置文件中，所有的容器通过services来定义...</p></div></div></a></div><div class="card"> <a href="/posts/Kubernetes%E6%A6%82%E8%BF%B0/"><div class="card-body"> <em class="timeago small" date="2022-02-17 00:00:00 +0800" >02-17</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kubernetes</h3><div class="text-muted small"><p> ​ K8s是谷歌在2014年开源的容器化集群管理系统，使用k8s进行容器化应用部署。k8s利于应用的扩展，让容器化应用更加简洁高效。 1.自动装箱 ​ 基于容器对应用运行环境的资源配置要求，自动部署应用容器 2.自我修复 ​ 当容器失败时，会对容器进行重启 ​ 当所部署的Node节点有问题时，会对容器进行重新部署和重新调度 ​ 当容器未通过监控检查时，会关闭此容器；直到容器正常...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Github%E7%9A%84ssh/" class="btn btn-outline-primary" prompt="上一篇"><p>Github中的SSH</p></a> <a href="/posts/docker%E5%9F%BA%E7%A1%80/" class="btn btn-outline-primary" prompt="下一篇"><p>Docker基础</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/carmanzheng">carmanzheng</a>. <span data-toggle="tooltip" data-placement="top" title="除非另有说明，本网站上的博客文章均由作者按照知识共享署名 4.0 国际 (CC BY 4.0) 许可协议进行授权。">保留部分权利。</span></p></div><div class="footer-right"><p class="mb-0"> 本站由 <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> 生成，采用 <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> 主题。</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">热门标签</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/mysql/">MySQL</a> <a class="post-tag" href="/tags/python%E5%9F%BA%E6%93%8D/">Python基操</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFjs/">前端JS</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFvue/">前端Vue</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFcss/">前端CSS</a> <a class="post-tag" href="/tags/devops/">DevOps</a> <a class="post-tag" href="/tags/linux%E5%9F%BA%E7%A1%80/">Linux基础</a> <a class="post-tag" href="/tags/%E5%89%8D%E7%AB%AFhtml/">前端HTML</a> <a class="post-tag" href="/tags/github/">Github</a> <a class="post-tag" href="/tags/%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BC%80%E5%8F%91/">客户端开发</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">搜索结果为空</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
